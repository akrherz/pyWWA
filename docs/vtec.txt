
TEXT_PRODUCT
 '-> SEGMENTS []
     '-> UGC []
     '-> VTEC []
     '-> Option HVTEC
     '-> Optimal Polygon Geometry   

 VTEC 
   # These things can not change over the lifetime of the VTEC product
   [year, class, eventid, phenomena, significance, wfo]
   # These things can change and are associated with a UGC
   [ugc, issue, expire, status]
   
CREATE TABLE vtec_phenomena(
  id char(2) UNIQUE,
  name varchar(256)
);

CREATE TABLE vtec_significance(
  id char(1) UNIQUE,
  name varchar(256)
);

CREATE TABLE vtec_class(
  id char(1) UNIQUE,
  name varchar(256)
);

CREATE TABLE vtec_status(
  id varchar(3) UNIQUE,
  name varchar(256)
);

CREATE TABLE vtec_events(
  id SERIAL UNIQUE,
  year    int,
  class char(1) REFERENCES vtec_class(id),
  center  char(4),
  phenomena char(2) REFERENCES vtec_phenomena(id),
  eventid int,
  significance char(1) REFERENCES vtec_significance(id),
  first_product varchar(32)
);
CREATE UNIQUE INDEX vtec_events_idx on 
	vtec_events(year, class, center, phenomena, eventid, significance);

CREATE TABLE ugc(
  id SERIAL UNIQUE,
  class char(1),
  ugc char(6),
  name varchar(256),
  state varchar(2),
  time_zone varchar(2),
  wfo varchar(9)
);
SELECT AddGeometryColumn('','ugc','geom',4326,'MULTIPOLYGON',2);

CREATE TABLE vtec_ugc_log(
  vtec_event int REFERENCES vtec_events(id) NOT NULL,
  ugc int REFERENCES ugc(id),
  begints timestamp with time zone,
  endts timestamp with time zone,
  status char(3) REFERENCES vtec_status(id),
  product varchar(32)
);

CREATE TABLE vtec_ugc_status(
  vtec_event int REFERENCES vtec_events(id) NOT NULL,
  ugc int REFERENCES ugc(id),
  begints timestamp with time zone,
  endts timestamp with time zone,
  status char(3) REFERENCES vtec_status(id),
  product varchar(32)
);
create index vtec_ugc_status_vtec_event_idx on vtec_ugc_status(vtec_event);

INSERT into vtec_status values ('EXT','extends time of');
INSERT into vtec_status values ('COR','corrects');
INSERT into vtec_status values ('EXB','extends area+time of');
INSERT into vtec_status values ('CAN','cancels');
INSERT into vtec_status values ('EXP','expires');
INSERT into vtec_status values ('EXA','extends area of');
INSERT into vtec_status values ('NEW','issues');
INSERT into vtec_status values ('UPG','issues upgrade to');
INSERT into vtec_status values ('ROU','routine');
INSERT into vtec_status values ('CON','continues');

INSERT into vtec_significance values ('A','Watch');
INSERT into vtec_significance values ('F','Forecast');
INSERT into vtec_significance values ('O','Outlook');
INSERT into vtec_significance values ('N','Synopsis');
INSERT into vtec_significance values ('S','Statement');
INSERT into vtec_significance values ('W','Warning');
INSERT into vtec_significance values ('Y','Advisory');

INSERT into vtec_phenomena values ('FR','Frost');
INSERT into vtec_phenomena values ('WC','Wind Chill');
INSERT into vtec_phenomena values ('FW','Red Flag');
INSERT into vtec_phenomena values ('FZ','Freeze');
INSERT into vtec_phenomena values ('BH','Beach Hazard');
INSERT into vtec_phenomena values ('WI','Wind');
INSERT into vtec_phenomena values ('WW','Winter Weather');
INSERT into vtec_phenomena values ('FA','Areal Flood');
INSERT into vtec_phenomena values ('BW','Brisk Wind');
INSERT into vtec_phenomena values ('WS','Winter Storm');
INSERT into vtec_phenomena values ('FF','Flash Flood');
INSERT into vtec_phenomena values ('FG','Dense Fog');
INSERT into vtec_phenomena values ('FL','Flood');
INSERT into vtec_phenomena values ('BZ','Blizzard');
INSERT into vtec_phenomena values ('RP','Rip Currents');
INSERT into vtec_phenomena values ('TO','Tornado');
INSERT into vtec_phenomena values ('RB','Small Craft for Rough');
INSERT into vtec_phenomena values ('CF','Coastal Flood');
INSERT into vtec_phenomena values ('GL','Gale');
INSERT into vtec_phenomena values ('SR','Storm');
INSERT into vtec_phenomena values ('SW','Small Craft for Hazardous');
INSERT into vtec_phenomena values ('SV','Severe Thunderstorm');
INSERT into vtec_phenomena values ('SU','High Surf');
INSERT into vtec_phenomena values ('SI','Small Craft for Winds');
INSERT into vtec_phenomena values ('SN','Snow');
INSERT into vtec_phenomena values ('SM','Dense Smoke');
INSERT into vtec_phenomena values ('SC','Small Craft');
INSERT into vtec_phenomena values ('SB','Snow and Blowing');
INSERT into vtec_phenomena values ('SE','Hazardous Seas');
INSERT into vtec_phenomena values ('HZ','Hard Freeze');
INSERT into vtec_phenomena values ('HY','Hydrologic');
INSERT into vtec_phenomena values ('HS','Heavy Snow');
INSERT into vtec_phenomena values ('BS','Blowing Snow');
INSERT into vtec_phenomena values ('HW','High Wind');
INSERT into vtec_phenomena values ('HT','Heat');
INSERT into vtec_phenomena values ('HU','Hurricane');
INSERT into vtec_phenomena values ('HI','Inland Hurricane');
INSERT into vtec_phenomena values ('DU','Blowing Dust');
INSERT into vtec_phenomena values ('HF','Hurricane Force Wind');
INSERT into vtec_phenomena values ('DS','Dust Storm');
INSERT into vtec_phenomena values ('LE','Lake Effect Snow');
INSERT into vtec_phenomena values ('LB','Lake Effect Snow and Blowing Snow');
INSERT into vtec_phenomena values ('TY','Typhoon');
INSERT into vtec_phenomena values ('LO','Low Water');
INSERT into vtec_phenomena values ('TR','Tropical Storm');
INSERT into vtec_phenomena values ('TS','Tsunami');
INSERT into vtec_phenomena values ('LW','Lake Wind');
INSERT into vtec_phenomena values ('LS','Lakeshore Flood');
INSERT into vtec_phenomena values ('TI','Inland Tropical Storm');
INSERT into vtec_phenomena values ('ZF','Freezing Fog');
INSERT into vtec_phenomena values ('UP','Ice Accretion');
INSERT into vtec_phenomena values ('EH','Excessive Heat');
INSERT into vtec_phenomena values ('AF','Ashfall');
INSERT into vtec_phenomena values ('IP','Sleet');
INSERT into vtec_phenomena values ('IS','Ice Storm');
INSERT into vtec_phenomena values ('EC','Extreme Cold');
INSERT into vtec_phenomena values ('AS','Air Stagnation');
INSERT into vtec_phenomena values ('EW','Extreme Wind');
INSERT into vtec_phenomena values ('ZR','Freezing Rain');
INSERT into vtec_phenomena values ('MF','Marine Dense Fog');
INSERT into vtec_phenomena values ('MA','Marine');
INSERT into vtec_phenomena values ('MH','Marine Ashfall');
INSERT into vtec_phenomena values ('MS','Marine Dense Smoke');

INSERT into vtec_class values ('X','Experimental VTEC');
INSERT into vtec_class values ('E','Experimental');
INSERT into vtec_class values ('T','Test');
INSERT into vtec_class values ('O','Operational');
